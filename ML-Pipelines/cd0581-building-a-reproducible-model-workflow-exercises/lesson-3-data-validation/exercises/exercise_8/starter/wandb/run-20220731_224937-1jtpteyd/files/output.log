[1mcollected 1 item                                                                                                                                                                                          
test_data.py::test_kolmogorov_smirnov [31mFAILED
================================================================================================ FAILURES =================================================================================================
[31m[1m_________________________________________________________________________________________ test_kolmogorov_smirnov _________________________________________________________________________________________
data = (       Unnamed: 0  Unnamed: 0.1  danceability  ...                                          song_name                ... NaN                            Lost Lands 2019                            Lost Lands 2019
[12593 rows x 20 columns])
    def test_kolmogorov_smirnov(data):
        sample1, sample2 = data
        numerical_columns = [
            "danceability",
            "energy",
            "loudness",
            "speechiness",
            "acousticness",
            "instrumentalness",
            "liveness",
            "valence",
            "tempo",
            "duration_ms"
        ]
        # Let's decide the Type I error probability (related to the False Positive Rate)
        alpha = 0.05
        # Bonferroni correction for multiple hypothesis testing
        # (see my blog post on this topic to see where this comes from:
        # https://towardsdatascience.com/precision-and-recall-trade-off-and-multiple-hypothesis-testing-family-wise-error-rate-vs-false-71a85057ca2b)
        alpha_prime = 1 - (1 - alpha)**(1 / len(numerical_columns))
        for col in numerical_columns:
            # Use the 2-sample KS test (scipy.stats.ks_2sample) on the column
            # col
            ts, p_value = scipy.stats.ks_2samp(sample1[col], sample2[col], alternative='two-sided')
            # Add an assertion so that the test fails if p_value > alpha_prime
>           assert p_value < alpha, f"The test has failed at significance level: {alpha}"
[31m[1mE           AssertionError: The test has failed at significance level: 0.05
[31m[1mE           assert 0.9157517178427169 < 0.05
[31m[1mtest_data.py[39m[22m:54: AssertionError
========================================================================================= short test summary info =========================================================================================
FAILED test_data.py::test_kolmogorov_smirnov - AssertionError: The test has failed at significance level: 0.05
[31m=========================================================================================== [1m1 failed[22m in 47.29s ============================================================================================